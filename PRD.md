# 产品需求文档

为了帮助不擅长/不愿意整理电脑文件的人，设计一个智能的资源管理器/finder产品。MVP能打动人的点在于对现有、可能杂乱的文件进行智能化的呈现和利用，很快就能获得“让人眼前一亮的文件聚类效果”。

我们要求用户在macOS和Windows上给读取文件夹的授权，然后监控文件变化，经过筛选、统计、分析后生成对用户有意义的聚类结果，形成一些“文件列表”，每个列表都是一个“智慧文件夹-wise folder”形态。智慧文件夹是本产品的核心功能之一，通过对文件的聚类分析，为用户提供一种全新的文件组织和浏览方式。类似Excel的视图并不改变原始数据，本App也不改变原始文件在硬盘上的位置，而只是在界面上提供更智能的呈现方式。

## 智慧文件夹(Wise Folder)概念

类似于Excel中的数据视图，是对原始文件的一种虚拟组织方式：

1. **不改变原始文件位置**：智慧文件夹仅是对文件元数据的引用和显示，不会移动或复制原始文件
2. **基于“精炼”的聚类**：利用LLM的智力根据“粗筛”数据生成“精炼”数据，将相关文件组织在一起
3. **多维度视角**：提供多种组织维度，如项目关联、内容相似性、使用模式等
4. **动态更新**：随着文件的增减和修改，智慧文件夹会自动更新，保持最新的组织状态

## 技术流程设计

在这个Tauri App中，是三种语言混合使用：TypeScript负责前端界面呈现和交互逻辑，Rust直接跟操作系统打交道，做文件查找和扫描，而Python负责处理数据和跟数据库打交道，也负责跟LLM交流。

技术流程概述：

1. 前端TypeScript跟Python API配合，按照Windows和macOS不同罗列常用文件夹，通过“完全磁盘访问权限”请求用户授权。
2. Rust的“粗筛”工作
   1. 读取文件元数据(路径、大小、时间戳、计算基本哈希，注意并不读取文件内容)，进行初步规则匹配(如扩展名分类、简单文件名模式等)
   2. 将更结构化的任务信息(包含元数据和初步分类结果)通过Python API入库到粗筛结果表
   3. 调用Python API通知它可以进行下一步工作，即将后续任务加入队列
3. Python worker从队列里拿到任务开始进行“精炼”工作： 处理更复杂的逻辑，如项目识别、高级规则、数据库操作、LLM交互等，其数据结论放入精炼结果表，以支撑智慧文件夹的前端呈现

这个设计的好处有：

- Rust运用高性能的I/O能力将频繁变更的文件元数据进行规则处理筛选后，传递给Python的任务量大大减少，减少了后续计算压力
- Python可以专注于更复杂的逻辑，并通过跟LLM的交互来提升数据的智能化表现，让“智慧文件夹”的呈现更具吸引力
