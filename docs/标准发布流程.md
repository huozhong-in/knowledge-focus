# 标准发布流程

## 推荐的标准发布流程

既然你已经有了正确的workflow文件，我来给你一个完整的发布流程：

### 方案1：使用release分支

```bash
# 1. 切换到release分支
git checkout release

# 2. 从main分支拉取最新代码
git merge main

# 3. 更新版本号
# 编辑 tauri-app/src-tauri/tauri.conf.json，修改版本号，如 "0.3.4"

# 4. 可选：更新releaseBody描述
# 编辑 .github/workflows/build-macos-release.yaml 中的 releaseBody

# 5. 提交并推送
git add .
git commit -m "release: bump version to 0.3.4"
git push origin release

# 6. 等待GitHub Actions完成构建

# 7. 在GitHub上将draft release改为正式发布

# 8. 将发布的改动合并回main（可选但推荐）
git checkout main
git merge release
git push origin main
```

### 方案2：使用Git Tag触发（更标准）

如果你想要更标准的做法，修改workflow也能做到基于tag触发：

```bash
# 基于tag的发布流程（推荐）
# 1. 在main分支更新版本和发布说明
git checkout main

# 2. 编辑版本号
# 编辑 tauri-app/src-tauri/tauri.conf.json 中的 "version": "0.3.4"
# 注意：不需要手动修改 src/version.ts，GitHub Actions 会自动同步

# 3. 编辑发布说明（重要：这会成为Release的内容）
# 编辑 .github/workflows/build-macos-release.yaml 中的 releaseBody 部分
# 更新 "### 📋 更新内容" 下的具体变更说明

# 4. 提交所有修改
git add .
git commit -m "release: bump version to 0.3.4"

# 5. 创建tag（tag名要与版本号对应）
git tag v0.3.4

# 6. 推送代码和tag
git push origin main
git push origin v0.3.4

# 7. 自动触发构建和发布
# GitHub Actions会自动创建draft release并上传所有bundle文件

# 8. 在GitHub上确认并发布
# 检查draft release，确认无误后点击"Publish release"
```

## 回答你的具体问题

### 1. 现在这个release分支要删除吗？

**建议保留**，原因：

- 可以作为专门的发布分支
- 保留commit历史
- 方便回溯发布过程

### 2. 关于分支管理

推荐两种方式：

#### 方式A：长期release分支

- 保留release分支，每次发布时合并main到release
- 好处：稳定，可以在release分支做发布相关的微调
- 坏处：需要维护两个分支

#### 方式B：基于tag的发布

- 删除release分支，改用git tag触发
- 好处：更标准，只需要维护main分支
- 坏处：灵活度较低
